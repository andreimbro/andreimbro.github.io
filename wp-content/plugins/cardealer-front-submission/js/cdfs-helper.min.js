!function(e){"use strict";function t(e){e.find(":submit").attr("disabled","disabled"),e.find(":submit").addClass("disabled")}function a(e,t,a){1==a.status?(jQuery(e).find("div.cdfs-msg").addClass("cdfs-message").html(a.message),jQuery(e).find("div.cdfs-msg").fadeIn("slow"),setTimeout((function(){jQuery("#cdfs_user_login").remove(),jQuery(".cdfs-user-account").length&&(jQuery("#cdfs_user_name").html(a.cdfs_user_name),jQuery(".cdfs-user-account").css("display","block")),jQuery("#cdfs-car-form-nonce-field").length>0&&jQuery("#cdfs-car-form-nonce-field").val(a.new_nouce),jQuery("#car_form_captcha").show(),jQuery("button.cdfs-submit-car").removeAttr("disabled"),jQuery("button.cdfs-submit-car").removeClass("disabled")}),5e3)):(jQuery(e).find("div.cdfs-msg").addClass("cardealer-error").html(a.message),jQuery(e).find("div.cdfs-msg").fadeIn("slow"),"undefined"!=typeof grecaptcha&&grecaptcha.reset(t)),e.find(":submit").removeAttr("disabled"),e.find(":submit").removeClass("disabled")}function r(e){jQuery.ajax({url:front_js.ajax_url,type:"POST",data:e,cache:!1,contentType:!1,processData:!1,beforeSend:function(){jQuery(".cdfs-submit-car-button .cdfs-processing-message").text(cdfs_obj.imageprocess)},success:function(e,t,a){var r=jQuery.parseJSON(e);!0===r.status?(jQuery(".cdfs-submit-car-button .cdfs-processing-message").text(cdfs_obj.redirectmsg),window.location.href=r.redirect):(jQuery(".cdfs-submit-car-button .cdfs-processing-message").remove(),"undefined"!=typeof grecaptcha&&grecaptcha.reset(carcaptchaWidgetId))},error:function(e,t,a){jQuery(".cdfs-submit-car-button .cdfs-processing-message").remove(),console.log("ERRORS: "+t),"undefined"!=typeof grecaptcha&&grecaptcha.reset(carcaptchaWidgetId),jQuery(".car-form-loader").remove(),jQuery(".cdfs-submit-car").removeAttr("disabled",!1),jQuery(".cdfs-submit-car").removeClass("disabled")},complete:function(){}})}function i(){var e=jQuery(".cdfs_uploaded_files").sortable("toArray",{attribute:"item"});jQuery(".cdfs_hidden_field").val(e);var t=jQuery(".cdfs_uploaded_files").sortable("toArray",{attribute:"file"});jQuery(".file_attachments").val(t)}e.fn.exists=function(){return this.length>0},jQuery(document).ready((function(){if(jQuery(".cdfs-autofill").length>0){var r=null;jQuery(".cdfs-autofill").autocomplete({delay:0,minLength:1,source:function(e,t){var a=jQuery(this.element).data("name");r=jQuery.ajax({url:front_js.ajax_url,type:"post",dataType:"json",jsonCallback:"jsonCallback",data:{action:"cdfs_get_autocomplete",search:e.term,fieldName:a},beforeSend:function(){null!=r&&r.abort()},success:function(e){t(jQuery.map(e.data,(function(t){return e.data.length>0?t:void 0})))},error:function(e){}})}})}if(jQuery(document).on("change","#cdfs-other",(function(){jQuery(this).is(":checked")?jQuery("#cdfs-cdfs-other-opt").removeClass("cdfs-hidden"):jQuery("#cdfs-cdfs-other-opt").addClass("cdfs-hidden")})),jQuery(document).on("click","a.delete-car",(function(e){e.preventDefault();var t=this;jQuery.confirm({title:cdfs_obj.alerttxt,content:cdfs_obj.delalerttex,buttons:{confirm:function(){window.location=t.href},cancel:function(){}}})})),jQuery(document).on("click",".drop_img_item",(function(){var e=jQuery("#cdfs-car-form-nonce-field").val(),t=jQuery(this).data("attach_id"),a=jQuery(this).data("parent_id"),r=jQuery(this).data("field"),c=jQuery(this).parent(".cdfs-item");jQuery.confirm({title:cdfs_obj.alerttxt,content:cdfs_obj.delalerttex,columnClass:"medium",buttons:{delete:{text:cdfs_obj.btn_delete,action:function(){jQuery.ajax({url:front_js.ajax_url,type:"post",dataType:"json",data:{action:"cdfs_delete_attachment",nonce:e,attach_id:t,field:r,parent_id:a},beforeSend:function(){},success:function(e){1==e.status&&(c.remove(),i())},error:function(e){}})}},cancel:function(){}}})})),jQuery(document).on("submit",".cdfs-add-car-page form#cdfs-form-user-login",(function(e){e.preventDefault();var r=jQuery(this).serializeArray(),i=jQuery(this),c=jQuery(this).find("#login_captcha").data("widget_id"),n=jQuery("#form-user-login").text();r.push({name:"action",value:"cdfs_do_ajax_user_login"}),jQuery.ajax({url:front_js.ajax_url,type:"post",dataType:"json",data:r,beforeSend:function(){t(i),jQuery("#form-user-login").html(n+' <i class="fa fa-spinner fa-spin car-form-loader" aria-hidden="true"></i>')},success:function(e){jQuery("#form-user-login").html(n),jQuery("#form-user-login").attr("disabled",!1),a(i,c,e)},error:function(e){}})})),jQuery(document).on("submit",".cdfs-add-car-page form#cdfs-form-register",(function(e){e.preventDefault();var r=jQuery(".cdfs-add-car-page form#cdfs-form-register"),i=jQuery(this).serializeArray(),c=jQuery(this).find("#register_captcha").data("widget_id"),n=jQuery("#cdfs-form-register-btn").text();i.push({name:"action",value:"cdfs_do_ajax_user_register"}),jQuery.ajax({url:front_js.ajax_url,type:"post",dataType:"json",data:i,beforeSend:function(){t(r),jQuery("#cdfs-form-register-btn").html(n+' <i class="fa fa-spinner fa-spin car-form-loader" aria-hidden="true"></i>')},success:function(e){jQuery("#cdfs-form-register-btn").html(n),jQuery("#cdfs-form-register-btn").attr("disabled",!1),a(r,c,e)},error:function(e){}})})),e("body").on("change",".cdfs-img-select-view-control",(function(){var t,a=this,r=e(a).closest(".cdfs-image-upload"),i=e(r).find(".select-file-label"),c=e(a).attr("dara-preview_el"),n=!1;if(e(c).exists()&&(n=!0,t=e(c)),a.files&&a.files[0]){var s=new FileReader,d=a.files[0];s.fileName=d.name,s.onload=function(a){e(i).html(a.target.fileName),n&&(t.find("img").attr("src",a.target.result),t.removeClass("without-image").addClass("with-image"))},s.readAsDataURL(a.files[0])}})),e(".cardealer-userdash-tabs").exists()&&e(".cardealer-userdash-tab > a").on("click",(function(t){t.preventDefault();e(this).attr("href");var a=e(this).data("tab_id");const r=new URL(vehicle_filter_js_object.author_url),i=r.searchParams;i.set("profile-tab",a),r.search=i.toString();var c=r.toString();history.pushState(null,null,c),vehicle_filter_js_object.cars_form_url=c})),e(".dealer-location-wrapper").exists()){var c=e(".dealer-location-wrapper"),n=c.find("#dealer-location-map"),s=c.find("#dealer_location"),d=c.find("#dealer_location_lat"),o=c.find("#dealer_location_lng"),l=c.find("#dealer_location_zoom");n.locationpicker({location:{latitude:e(d).val(),longitude:e(o).val()},zoom:parseInt(e(l).val()),radius:0,inputBinding:{locationNameInput:e(s),latitudeInput:e(d),longitudeInput:e(o)},enableAutocomplete:!0,onchanged:function(e,t,a){}}),n.data("locationpicker").map.addListener("zoom_changed",(function(){var t=n.data("locationpicker").map;e(".dealer-location-wrapper").find("#dealer_location_zoom").val(t.getZoom())}))}})),jQuery(window).load((function(){if(document.getElementById("car_form_captcha")){var e=document.getElementById("car_form_captcha").dataset.sitekey,t=grecaptcha.render("car_form_captcha",{sitekey:e,theme:"light"});document.getElementById("car_form_captcha").dataset.widget_id=t}if(document.getElementById("login_captcha")){var a=document.getElementById("login_captcha").dataset.sitekey,r=grecaptcha.render("login_captcha",{sitekey:a,theme:"light"});document.getElementById("login_captcha").dataset.widget_id=r}if(document.getElementById("register_captcha")){a=document.getElementById("register_captcha").dataset.sitekey;var i=grecaptcha.render("register_captcha",{sitekey:a,theme:"light"});document.getElementById("register_captcha").dataset.widget_id=i}})),jQuery(document).ready((function(){var t="";if(n(a=0),e(".cdfs-add-car-package").exists()){(c=e('.cdfs-add-car-package[name="subscription_plan"]:checked')).val();var a=c.data("image_limit");t=c.data("submit_type"),n(a)}else if(e(".cdfs-add-car-package-hidden").length>0){var c;(c=e(".cdfs-add-car-package-hidden")).val(),a=c.data("image_limit");t=c.data("submit_type"),n(a)}function n(t){e(".upload-image-limit .upload-image-limit-count").exists()&&e(".upload-image-limit .upload-image-limit-count").html(t)}e("body").on("change",'.cdfs-add-car-package[name="subscription_plan"]',(function(r){c=e(r.target),c.val(),a=c.data("image_limit"),t=c.data("submit_type"),n(a)}));var s=[];jQuery(".cdfs_uploaded_files").length>0&&jQuery((function(){jQuery(".cdfs_uploaded_files").sortable({cursor:"move",placeholder:"highlight",start:function(e,t){t.item.toggleClass("highlight")},stop:function(e,t){t.item.toggleClass("highlight")},update:function(){i()},create:function(){var e=this,t=function(){jQuery(e).css("height","auto"),jQuery(e).height(jQuery(e).height())};jQuery(e).height(jQuery(e).height()),jQuery(e).find("img").load(t).error(t)}}),jQuery(".cdfs_uploaded_files").disableSelection()})),jQuery("body").on("change",".user_picked_files",(function(){var t=this.files,r=e(this).data("image_size_limit"),i=0,n=jQuery(".cdfs_uploaded_files li").length;if(n+=this.files.length,void 0===a&&(a=0),n>a)return 0===a&&0===c.length?e.alert({title:cdfs_obj.errortxt,content:cdfs_obj.img_select_package_err,columnClass:"medium"}):e.alert({title:cdfs_obj.errortxt,content:cdfs_obj.imglimittxt.replace("{{limit}}",a),columnClass:"medium"}),void jQuery(this).val("");var d=[],o=[];for(i=0;i<t.length;i++){var l=new FileReader,u=t[i],f=u.name,m=u.size;u.type.match("image.*")?m<=r?(s.push(u),l.onload=function(e){jQuery(".cdfs_uploaded_files").append("<li file = '"+f+"'><img class = 'img-thumb' src = '"+e.target.result+"' /><a href = '#' class = 'cdfs_delete_image' title = 'Cancel'><span class=remove>x</span></a></li>")},l.readAsDataURL(u)):o.push(f):d.push(f),t.length===i+1&&setTimeout((function(){jQuery(".cdfs_uploaded_files li").each((function(e){jQuery(this).attr("item",e)}))}),1e3)}if(d.length>0){const t=document.createElement("ul");for(i=0;i<=d.length-1;i++){const e=document.createElement("li");e.innerHTML=d[i],t.appendChild(e)}e.alert({title:cdfs_obj.img_type_title,content:cdfs_obj.img_type_error+"<br><br>"+t.outerHTML,columnClass:"medium"})}if(o.length>0){const t=document.createElement("ul");for(i=0;i<=o.length-1;i++){const e=document.createElement("li");e.innerHTML=o[i],t.appendChild(e)}e.alert({title:cdfs_obj.size_exceed_title,content:cdfs_obj.size_exceed_error+"<br><br>"+t.outerHTML,columnClass:"medium"})}})),jQuery("body").on("change","#car-pdf",(function(){var e=this.files;e[0].type.match("application/pdf")||jQuery.alert({title:cdfs_obj.errortxt,content:cdfs_obj.pdftypetxt.replace("[file]",e[0].name),columnClass:"medium"})})),jQuery("body").on("click","a.cdfs_delete_image",(function(e){e.preventDefault(),jQuery(this).parent().remove("");for(var t=jQuery(this).parent().attr("file"),a=0;a<s.length;a++)if(s[a].name==t){s.splice(a,1);break}})),jQuery(document).on("click",".cdfs-submit-car",(function(){(i(),void 0===c||0!==c.length)?jQuery(".cdfs_uploaded_files li").length>a?e.alert({title:cdfs_obj.errortxt,content:cdfs_obj.imglimittxt.replace("{{limit}}",a),columnClass:"medium"}):(jQuery(this).attr("disabled",!0).addClass("disabled"),jQuery(this).append('<i class="fa fa-spinner fa-spin car-form-loader" aria-hidden="true"></i>'),jQuery(".switch-tmce").click(),jQuery("textarea.cdfs_editor").each((function(e,t){var a=tinyMCE.get(jQuery(this).attr("id")).getContent();jQuery(this).val(a)})),e("#avf_submit_type").exists()?e("#avf_submit_type").val(t):e("<input>").attr({type:"hidden",name:"submit_type",id:"avf_submit_type",value:t}).appendTo("#cdfs_car_form"),jQuery("#cdfs_car_form").submit()):e.alert({title:cdfs_obj.errortxt,content:cdfs_obj.select_package_err,columnClass:"medium"})})),jQuery(document).on("submit","#cdfs_car_form",(function(t){t.stopPropagation(),t.preventDefault();var a=jQuery(this).find("#car_form_captcha").data("widget_id"),i=new FormData,c=0;if(jQuery.each(s,(function(e,t){i.append("car_images["+e+"]",t),c++})),jQuery("#car-pdf").length>0){var n=jQuery("#car-pdf").prop("files")[0];i.append("pdf_file",n)}var d=1;jQuery(".review_stamp_logo").each((function(){var e=jQuery("#review_stamp_logo_"+d).prop("files")[0];i.append("review_stamp_logo_"+d,e),d++})),i.append("action","cdfs_upload_images"),i.append("file_attachments",jQuery("#file_attachments").val());var o=jQuery(t.target).serializeArray();o.push({name:"action",value:"cdfs_save_car"}),o.push({name:"car_img_cnt",value:c}),e.ajax({url:front_js.ajax_url,type:"POST",data:o,cache:!1,dataType:"json",beforeSend:function(){jQuery(".invalid_fields").removeClass("invalid_fields"),jQuery(".cdfs-submit-car-button").append('<p class="cdfs-processing-message">'+cdfs_obj.vehicleprocess+"</p>")},success:function(t,c,n){if(!0===t.status){jQuery(".cdfs-submit-car-button .cdfs-processing-message").text(t.message),i.append("car_id",t.car_id),i.append("submit_type",t.submit_type),i.append("type",t.type),(function(e){var t=new URLSearchParams(window.location.search).get(e);null===t&&(t=!1);return t}("is_webview")||e("body").hasClass("cardealer-webview"))&&i.append("is_webview","yes"),r(i)}else{jQuery(".cdfs-submit-car-button .cdfs-processing-message").remove(),jQuery(".cardealer-error").remove();var s='<ul class="cardealer-error"><li>'+t.message+"</li></ul>";jQuery(".entry-content .cdfs").prepend(s),t.invalid_fields.length>0&&jQuery(t.invalid_fields).each((function(e,t){jQuery("#cdfs_car_form").find("input#cdfs-"+t).addClass("invalid_fields")})),"undefined"!=typeof grecaptcha&&grecaptcha.reset(a);var d="#main";e("#main .content-wrapper-vc-enabled").length>0?d="#main .content-wrapper-vc-enabled":e("#main .page-section-ptb.content-wrapper").length>0?d="#main .page-section-ptb.content-wrapper":e("#main > #primary").length>0&&(d="#main > #primary"),jQuery("html, body").animate({scrollTop:jQuery(d).offset().top},800),jQuery(".car-form-loader").remove(),jQuery(".cdfs-submit-car").removeAttr("disabled",!1),jQuery(".cdfs-submit-car").removeClass("disabled")}},error:function(e,t,r){jQuery(".cdfs-submit-car-button .cdfs-processing-message").remove(),console.log("ERRORS: "+t),jQuery(".car-form-loader").remove(),jQuery(".cdfs-submit-car").removeAttr("disabled",!1),jQuery(".cdfs-submit-car").removeClass("disabled"),"undefined"!=typeof grecaptcha&&grecaptcha.reset(a)},complete:function(){}})}))})),jQuery(document).ready((function(){jQuery("#cdfs-vehicle-location-area").length>0&&jQuery("#cdfs-vehicle-location-area").locationpicker({location:{latitude:jQuery("#cdfs-lat").val(),longitude:jQuery("#cdfs-lng").val()},radius:0,inputBinding:{latitudeInput:jQuery("#cdfs-lat"),longitudeInput:jQuery("#cdfs-lng"),locationNameInput:jQuery("#cdfs-vehicle-location")},enableAutocomplete:!0,onchanged:function(e,t,a){}})}))}(jQuery);